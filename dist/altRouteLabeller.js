!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).altRouteLabeller={})}(this,(function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var r=function(e){var t={exports:{}};return e(t,t.exports),t.exports}((function(e,t){function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){return void 0===n&&(n={}),r({type:"Point",coordinates:e},t,n)}function o(e,t,n){void 0===n&&(n={});for(var o=0,i=e;o<i.length;o++){var u=i[o];if(u.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<u[u.length-1].length;a++)if(u[u.length-1][a]!==u[0][a])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function i(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function u(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function a(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function s(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function c(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function l(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function f(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function d(e){return 180*(e%(2*Math.PI))/Math.PI}function g(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(e){case"Point":return n(t).geometry;case"LineString":return i(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return s(t).geometry;case"MultiLineString":return a(t).geometry;case"MultiPolygon":return c(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),u(e.map((function(e){return n(e,t)})),r)},t.polygon=o,t.polygons=function(e,t,r){return void 0===r&&(r={}),u(e.map((function(e){return o(e,t)})),r)},t.lineString=i,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),u(e.map((function(e){return i(e,t)})),r)},t.featureCollection=u,t.multiLineString=a,t.multiPoint=s,t.multiPolygon=c,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=l,t.lengthToRadians=f,t.lengthToDegrees=function(e,t){return d(f(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=d,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return l(f(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[r];if(!o)throw new Error("invalid original units");var i=t.areaFactors[n];if(!i)throw new Error("invalid final units");return e/o*i},t.isNumber=g,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!g(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}}));function n(e,t,r){if(null!==e)for(var o,i,u,a,s,c,l,f,d=0,g=0,h=e.type,p="FeatureCollection"===h,y="Feature"===h,m=p?e.features.length:1,v=0;v<m;v++){s=(f=!!(l=p?e.features[v].geometry:y?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var w=0;w<s;w++){var b=0,M=0;if(null!==(a=f?l.geometries[w]:l)){c=a.coordinates;var P=a.type;switch(d=!r||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===t(c,g,v,b,M))return!1;g++,b++;break;case"LineString":case"MultiPoint":for(o=0;o<c.length;o++){if(!1===t(c[o],g,v,b,M))return!1;g++,"MultiPoint"===P&&b++}"LineString"===P&&b++;break;case"Polygon":case"MultiLineString":for(o=0;o<c.length;o++){for(i=0;i<c[o].length-d;i++){if(!1===t(c[o][i],g,v,b,M))return!1;g++}"MultiLineString"===P&&b++,"Polygon"===P&&M++}"Polygon"===P&&b++;break;case"MultiPolygon":for(o=0;o<c.length;o++){for(M=0,i=0;i<c[o].length;i++){for(u=0;u<c[o][i].length-d;u++){if(!1===t(c[o][i][u],g,v,b,M))return!1;g++}M++}b++}break;case"GeometryCollection":for(o=0;o<a.geometries.length;o++)if(!1===n(a.geometries[o],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function i(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function u(e,t){var r,n,o,i,u,a,s,c,l,f,d=0,g="FeatureCollection"===e.type,h="Feature"===e.type,p=g?e.features.length:1;for(r=0;r<p;r++){for(a=g?e.features[r].geometry:h?e.geometry:e,c=g?e.features[r].properties:h?e.properties:{},l=g?e.features[r].bbox:h?e.bbox:void 0,f=g?e.features[r].id:h?e.id:void 0,u=(s=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<u;o++)if(null!==(i=s?a.geometries[o]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,d,c,l,f))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===t(i.geometries[n],d,c,l,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,d,c,l,f))return!1;d++}}function a(e,t){u(e,(function(e,n,o,i,u){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(r.feature(e,o,{bbox:i,id:u}),n,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<e.coordinates.length;c++){var l={type:a,coordinates:e.coordinates[c]};if(!1===t(r.feature(l,o),n,c))return!1}}))}function s(e,t){a(e,(function(e,o,i){var u=0;if(e.geometry){var a=e.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var s,c=0,l=0,f=0;return!1!==n(e,(function(n,a,d,g,h){if(void 0===s||o>c||g>l||h>f)return s=n,c=o,l=g,f=h,void(u=0);var p=r.lineString([s,n],e.properties);if(!1===t(p,o,i,h,u))return!1;u++,s=n}))&&void 0}}}))}function c(e,t){if(!e)throw new Error("geojson is required");a(e,(function(e,n,o){if(null!==e.geometry){var i=e.geometry.type,u=e.geometry.coordinates;switch(i){case"LineString":if(!1===t(e,n,o,0,0))return!1;break;case"Polygon":for(var a=0;a<u.length;a++)if(!1===t(r.lineString(u[a],e.properties),n,o,a))return!1}}}))}var l=n,f=function(e,t,r,o){var i=r;return n(e,(function(e,n,o,u,a){i=0===n&&void 0===r?e:t(i,e,n,o,u,a)}),o),i},d=o,g=function(e,t,r){var n=r;return o(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n},h=i,p=function(e,t,r){var n=r;return i(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n},y=function(e){var t=[];return n(e,(function(e){t.push(e)})),t},m=u,v=function(e,t,r){var n=r;return u(e,(function(e,o,i,u,a){n=0===o&&void 0===r?e:t(n,e,o,i,u,a)})),n},w=a,b=function(e,t,r){var n=r;return a(e,(function(e,o,i){n=0===o&&0===i&&void 0===r?e:t(n,e,o,i)})),n},M=s,P=function(e,t,r){var n=r,o=!1;return s(e,(function(e,i,u,a,s){n=!1===o&&void 0===r?e:t(n,e,i,u,a,s),o=!0})),n},E=c,S=function(e,t,r){var n=r;return c(e,(function(e,o,i,u){n=0===o&&void 0===r?e:t(n,e,o,i,u)})),n},R=function(e,t){if(t=t||{},!r.isObject(t))throw new Error("options is invalid");var n,o=t.featureIndex||0,i=t.multiFeatureIndex||0,u=t.geometryIndex||0,a=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o),s=s||e.features[o].properties,n=e.features[o].geometry;break;case"Feature":s=s||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),r.lineString([c[a],c[a+1]],s,t);case"Polygon":return u<0&&(u=c.length+u),a<0&&(a=c[u].length+a-1),r.lineString([c[u][a],c[u][a+1]],s,t);case"MultiLineString":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a-1),r.lineString([c[i][a],c[i][a+1]],s,t);case"MultiPolygon":return i<0&&(i=c.length+i),u<0&&(u=c[i].length+u),a<0&&(a=c[i][u].length-a-1),r.lineString([c[i][u][a],c[i][u][a+1]],s,t)}throw new Error("geojson is invalid")},x=function(e,t){if(t=t||{},!r.isObject(t))throw new Error("options is invalid");var n,o=t.featureIndex||0,i=t.multiFeatureIndex||0,u=t.geometryIndex||0,a=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o),s=s||e.features[o].properties,n=e.features[o].geometry;break;case"Feature":s=s||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return r.point(c,s,t);case"MultiPoint":return i<0&&(i=c.length+i),r.point(c[i],s,t);case"LineString":return a<0&&(a=c.length+a),r.point(c[a],s,t);case"Polygon":return u<0&&(u=c.length+u),a<0&&(a=c[u].length+a),r.point(c[u][a],s,t);case"MultiLineString":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a),r.point(c[i][a],s,t);case"MultiPolygon":return i<0&&(i=c.length+i),u<0&&(u=c[i].length+u),a<0&&(a=c[i][u].length-a),r.point(c[i][u][a],s,t)}throw new Error("geojson is invalid")},T=Object.defineProperty({coordEach:l,coordReduce:f,propEach:d,propReduce:g,featureEach:h,featureReduce:p,coordAll:y,geomEach:m,geomReduce:v,flattenEach:w,flattenReduce:b,segmentEach:M,segmentReduce:P,lineEach:E,lineReduce:S,findSegment:R,findPoint:x},"__esModule",{value:!0});var F=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")};var L=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")};var j=function e(t){if(t.length>1&&r.isNumber(t[0])&&r.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")};var k=function(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)};var A=function(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)};var O=function(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,o=e.features;n<o.length;n++){var i=o[n];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!i.geometry||i.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+i.geometry.type)}};var C=function(e){return"Feature"===e.type?e.geometry:e};var I=function(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type},_=Object.defineProperty({getCoord:F,getCoords:L,containsNumber:j,geojsonType:k,featureOf:A,collectionOf:O,getGeom:C,getType:I},"__esModule",{value:!0});function q(e,t,n){if(void 0===n&&(n={}),!0===n.final)return function(e,t){var r=q(t,e);return r=(r+180)%360}(e,t);var o=_.getCoord(e),i=_.getCoord(t),u=r.degreesToRadians(o[0]),a=r.degreesToRadians(i[0]),s=r.degreesToRadians(o[1]),c=r.degreesToRadians(i[1]),l=Math.sin(a-u)*Math.cos(c),f=Math.cos(s)*Math.sin(c)-Math.sin(s)*Math.cos(c)*Math.cos(a-u);return r.radiansToDegrees(Math.atan2(l,f))}var G=q,D=Object.defineProperty({default:G},"__esModule",{value:!0});var N=function(e,t,n,o){void 0===o&&(o={});var i=_.getCoord(e),u=r.degreesToRadians(i[0]),a=r.degreesToRadians(i[1]),s=r.degreesToRadians(n),c=r.lengthToRadians(t,o.units),l=Math.asin(Math.sin(a)*Math.cos(c)+Math.cos(a)*Math.sin(c)*Math.cos(s)),f=u+Math.atan2(Math.sin(s)*Math.sin(c)*Math.cos(a),Math.cos(c)-Math.sin(a)*Math.sin(l)),d=r.radiansToDegrees(f),g=r.radiansToDegrees(l);return r.point([d,g],o.properties)},V=Object.defineProperty({default:N},"__esModule",{value:!0});var B=function(e,t,n){void 0===n&&(n={});var o=_.getCoord(e),i=_.getCoord(t),u=r.degreesToRadians(i[1]-o[1]),a=r.degreesToRadians(i[0]-o[0]),s=r.degreesToRadians(o[1]),c=r.degreesToRadians(i[1]),l=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(c);return r.radiansToLength(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),n.units)},z=Object.defineProperty({default:B},"__esModule",{value:!0}),J=t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},U=J(D),W=J(V),X=J(z);var $=function(e,t,n){void 0===n&&(n={});for(var o=_.getGeom(e).coordinates,i=0,u=0;u<o.length&&!(t>=i&&u===o.length-1);u++){if(i>=t){var a=t-i;if(a){var s=U.default(o[u],o[u-1])-180;return W.default(o[u],a,s,n)}return r.point(o[u])}i+=X.default(o[u],o[u+1],n)}return r.point(o[o.length-1])},H=(t&&t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(z);var K=function(e,t){return void 0===t&&(t={}),T.segmentReduce(e,(function(e,r){var n=r.geometry.coordinates;return e+H.default(n[0],n[1],t)}),0)};function Q(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function Y(e){return function t(r){return 0===arguments.length||Q(r)?t:e.apply(this,arguments)}}function Z(e){return function t(r,n){switch(arguments.length){case 0:return t;case 1:return Q(r)?t:Y((function(t){return e(r,t)}));default:return Q(r)&&Q(n)?t:Q(r)?Y((function(t){return e(t,n)})):Q(n)?Y((function(t){return e(r,t)})):e(r,n)}}}var ee=Z((function(e,t){return Number(e)+Number(t)}));function te(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,r){return t.apply(this,arguments)};case 3:return function(e,r,n){return t.apply(this,arguments)};case 4:return function(e,r,n,o){return t.apply(this,arguments)};case 5:return function(e,r,n,o,i){return t.apply(this,arguments)};case 6:return function(e,r,n,o,i,u){return t.apply(this,arguments)};case 7:return function(e,r,n,o,i,u,a){return t.apply(this,arguments)};case 8:return function(e,r,n,o,i,u,a,s){return t.apply(this,arguments)};case 9:return function(e,r,n,o,i,u,a,s,c){return t.apply(this,arguments)};case 10:return function(e,r,n,o,i,u,a,s,c,l){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function re(e,t,r){return function(){for(var n=[],o=0,i=e,u=0;u<t.length||o<arguments.length;){var a;u<t.length&&(!Q(t[u])||o>=arguments.length)?a=t[u]:(a=arguments[o],o+=1),n[u]=a,Q(a)||(i-=1),u+=1}return i<=0?r.apply(this,n):te(i,re(e,n,r))}}var ne=Z((function(e,t){return 1===e?Y(t):te(e,re(e,[],t))}));function oe(e){return function t(r,n,o){switch(arguments.length){case 0:return t;case 1:return Q(r)?t:Z((function(t,n){return e(r,t,n)}));case 2:return Q(r)&&Q(n)?t:Q(r)?Z((function(t,r){return e(t,n,r)})):Q(n)?Z((function(t,n){return e(r,t,n)})):Y((function(t){return e(r,n,t)}));default:return Q(r)&&Q(n)&&Q(o)?t:Q(r)&&Q(n)?Z((function(t,r){return e(t,r,o)})):Q(r)&&Q(o)?Z((function(t,r){return e(t,n,r)})):Q(n)&&Q(o)?Z((function(t,n){return e(r,t,n)})):Q(r)?Y((function(t){return e(t,n,o)})):Q(n)?Y((function(t){return e(r,t,o)})):Q(o)?Y((function(t){return e(r,n,t)})):e(r,n,o)}}}var ie=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)};function ue(e){return null!=e&&"function"==typeof e["@@transducer/step"]}function ae(e,t,r){return function(){if(0===arguments.length)return r();var n=Array.prototype.slice.call(arguments,0),o=n.pop();if(!ie(o)){for(var i=0;i<e.length;){if("function"==typeof o[e[i]])return o[e[i]].apply(o,n);i+=1}if(ue(o)){var u=t.apply(null,n);return u(o)}}return r.apply(this,arguments)}}var se=function(){return this.xf["@@transducer/init"]()},ce=function(e){return this.xf["@@transducer/result"](e)};function le(e){return"[object String]"===Object.prototype.toString.call(e)}var fe=Y((function(e){return!!ie(e)||!!e&&("object"==typeof e&&(!le(e)&&(1===e.nodeType?!!e.length:0===e.length||e.length>0&&(e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1)))))})),de=function(){function e(e){this.f=e}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(e){return e},e.prototype["@@transducer/step"]=function(e,t){return this.f(e,t)},e}();var ge=Z((function(e,t){return te(e.length,(function(){return e.apply(t,arguments)}))}));function he(e,t,r){for(var n=r.next();!n.done;){if((t=e["@@transducer/step"](t,n.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}n=r.next()}return e["@@transducer/result"](t)}function pe(e,t,r,n){return e["@@transducer/result"](r[n](ge(e["@@transducer/step"],e),t))}var ye="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function me(e,t,r){if("function"==typeof e&&(e=function(e){return new de(e)}(e)),fe(r))return function(e,t,r){for(var n=0,o=r.length;n<o;){if((t=e["@@transducer/step"](t,r[n]))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}n+=1}return e["@@transducer/result"](t)}(e,t,r);if("function"==typeof r["fantasy-land/reduce"])return pe(e,t,r,"fantasy-land/reduce");if(null!=r[ye])return he(e,t,r[ye]());if("function"==typeof r.next)return he(e,t,r);if("function"==typeof r.reduce)return pe(e,t,r,"reduce");throw new TypeError("reduce: list must be array or iterable")}var ve=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=se,e.prototype["@@transducer/result"]=ce,e.prototype["@@transducer/step"]=function(e,t){return this.xf["@@transducer/step"](e,this.f(t))},e}(),we=Z((function(e,t){return new ve(e,t)}));function be(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var Me=Object.prototype.toString,Pe=function(){return"[object Arguments]"===Me.call(arguments)?function(e){return"[object Arguments]"===Me.call(e)}:function(e){return be("callee",e)}}(),Ee=!{toString:null}.propertyIsEnumerable("toString"),Se=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Re=function(){return arguments.propertyIsEnumerable("length")}(),xe=function(e,t){for(var r=0;r<e.length;){if(e[r]===t)return!0;r+=1}return!1},Te="function"!=typeof Object.keys||Re?Y((function(e){if(Object(e)!==e)return[];var t,r,n=[],o=Re&&Pe(e);for(t in e)!be(t,e)||o&&"length"===t||(n[n.length]=t);if(Ee)for(r=Se.length-1;r>=0;)be(t=Se[r],e)&&!xe(n,t)&&(n[n.length]=t),r-=1;return n})):Y((function(e){return Object(e)!==e?[]:Object.keys(e)})),Fe=Z(ae(["fantasy-land/map","map"],we,(function(e,t){switch(Object.prototype.toString.call(t)){case"[object Function]":return ne(t.length,(function(){return e.call(this,t.apply(this,arguments))}));case"[object Object]":return me((function(r,n){return r[n]=e(t[n]),r}),{},Te(t));default:return function(e,t){for(var r=0,n=t.length,o=Array(n);r<n;)o[r]=e(t[r]),r+=1;return o}(e,t)}}))),Le=Number.isInteger||function(e){return e<<0===e},je=Z((function(e,t){var r=e<0?t.length+e:e;return le(t)?t.charAt(r):t[r]})),ke=Z((function(e,t){return e.map((function(e){for(var r,n=t,o=0;o<e.length;){if(null==n)return;r=e[o],n=Le(r)?je(r,n):n[r],o+=1}return n}))})),Ae=Z((function(e,t){return ke([e],t)[0]})),Oe=Z((function(e,t){return Ae([e],t)})),Ce=oe(me),Ie=Y((function(e){return ne(e.length,e)}));function _e(e,t){return function(){return t.call(this,e.apply(this,arguments))}}function qe(e,t){return function(){var r=arguments.length;if(0===r)return t();var n=arguments[r-1];return ie(n)||"function"!=typeof n[e]?t.apply(this,arguments):n[e].apply(n,Array.prototype.slice.call(arguments,0,r-1))}}var Ge=Y(qe("tail",oe(qe("slice",(function(e,t,r){return Array.prototype.slice.call(r,e,t)})))(1,1/0)));function De(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return te(arguments[0].length,Ce(_e,arguments[0],Ge(arguments)))}var Ne=Z((function(e,t){return null==t||t!=t?e:t})),Ve=function(){function e(e,t){this.xf=t,this.pred=e,this.lastValue=void 0,this.seenFirstValue=!1}return e.prototype["@@transducer/init"]=se,e.prototype["@@transducer/result"]=ce,e.prototype["@@transducer/step"]=function(e,t){var r=!1;return this.seenFirstValue?this.pred(this.lastValue,t)&&(r=!0):this.seenFirstValue=!0,this.lastValue=t,r?e:this.xf["@@transducer/step"](e,t)},e}(),Be=Z((function(e,t){return new Ve(e,t)})),ze=je(-1),Je=Z(ae([],Be,(function(e,t){var r=[],n=1,o=t.length;if(0!==o)for(r[0]=t[0];n<o;)e(ze(r),t[n])||(r[r.length]=t[n]),n+=1;return r}))),Ue=Ce(ee,0),We=Y((function(e){return Ue(e)/e.length}));const Xe=(e,t)=>Math.abs(e-t)<1e-6,$e=e=>"".concat(e[0].toFixed(6),",").concat(e[1].toFixed(6)),He=Ie(((e,t)=>{const r=K(t);return{lngLat:F($(t,r*e)),localLineBearing:G($(t,r*(e-.1)),$(t,r*(e+.1)))}}));function Ke(e){if(e.length<2)return e;const t=e.map(y),n=new Map;return[].concat(...t).forEach((e=>{n.set($e(e),(n.get($e(e))||0)+1)})),t.map((e=>function(e,t){const n=e.findIndex((e=>1===t.get($e(e))));if(-1===n)return r.lineString(e);const o=n+e.slice(n).findIndex((e=>1!==t.get($e(e))));return r.lineString(e.slice(n,o))}(e,n)))}const Qe=De(y,Je((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Xe(e[0],t[0])&&Xe(e[1],t[1])})),r.lineString);function Ye(e){return e.map(((t,r)=>{const n=function(e,t){return De(Fe((t=>G(t.lngLat,e.lngLat))),We,Ne(0))(t)}(t,[...e.slice(0,r),...e.slice(r+1)]);return{lngLat:t.lngLat,anchor:Ze(t,n)}}))}function Ze(e,t){return"vertical"===(Math.abs(e.localLineBearing)<45||Math.abs(e.localLineBearing)>135?"vertical":"horizontal")?t>0?"left":"right":Math.abs(t)<90?"bottom":"top"}e.findDistinctSegments=Ke,e.getLabelPositions=function(e){return De(Oe("features"),Fe(Qe),Ke,Fe(He(.5)),Ye)(e)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=altRouteLabeller.js.map
